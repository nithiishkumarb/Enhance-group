import{Id as te,M as _,N as C,T as d,Za as j,aa as S,ba as V,ee as D,y as X}from"./chunk-7OOXQFUB.js";import{Aa as b,Ba as x,Cb as v,J as U,Ja as H,K as w,Pa as Z,Qa as J,Ra as z,Sa as G,Sb as ee,Ya as Y,_a as h,ib as E,mb as q,na as B,pa as O,s as L,ya as Q}from"./chunk-2KNKNWMU.js";import{Fa as y,Ia as F,Ma as p,ae as K,e as P,mb as k,oa as N,se as W,vb as I,we as $}from"./chunk-YRZDTKHG.js";import{j as u}from"./chunk-Z4H5XVQJ.js";u();u();var R=new F("WindowToken"),m=class{get nativeWindow(){throw new Error("Not implemented.")}},de=(()=>{let a=class a extends m{constructor(){super()}get nativeWindow(){return window}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=y({token:a,factory:a.\u0275fac});let r=a;return r})();function ce(r,a){return $(a)?r.nativeWindow:new Object}var ue={provide:m,useClass:de},pe={provide:R,useFactory:ce,deps:[m,I]},be=[ue,pe];u();var re={red:{50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},pink:{50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"},purple:{50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},"deep-purple":{50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",A100:"#b388ff",A200:"#7c4dff",A400:"#651fff",A700:"#6200ea"},indigo:{50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"},blue:{50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},"light-blue":{50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},cyan:{50:"#e0f7fa",100:"#b2ebf2",200:"#80deea",300:"#4dd0e1",400:"#26c6da",500:"#00bcd4",600:"#00acc1",700:"#0097a7",800:"#00838f",900:"#006064",A100:"#84ffff",A200:"#18ffff",A400:"#00e5ff",A700:"#00b8d4"},teal:{50:"#e0f2f1",100:"#b2dfdb",200:"#80cbc4",300:"#4db6ac",400:"#26a69a",500:"#009688",600:"#00897b",700:"#00796b",800:"#00695c",900:"#004d40",A100:"#a7ffeb",A200:"#64ffda",A400:"#1de9b6",A700:"#00bfa5"},green:{50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},"light-green":{50:"#f1f8e9",100:"#dcedc8",200:"#c5e1a5",300:"#aed581",400:"#9ccc65",500:"#8bc34a",600:"#7cb342",700:"#689f38",800:"#558b2f",900:"#33691e",A100:"#ccff90",A200:"#b2ff59",A400:"#76ff03",A700:"#64dd17"},lime:{50:"#f9fbe7",100:"#f0f4c3",200:"#e6ee9c",300:"#dce775",400:"#d4e157",500:"#cddc39",600:"#c0ca33",700:"#afb42b",800:"#9e9d24",900:"#827717",A100:"#f4ff81",A200:"#eeff41",A400:"#c6ff00",A700:"#aeea00"},yellow:{50:"#fffde7",100:"#fff9c4",200:"#fff59d",300:"#fff176",400:"#ffee58",500:"#ffeb3b",600:"#fdd835",700:"#fbc02d",800:"#f9a825",900:"#f57f17",A100:"#ffff8d",A200:"#ffff00",A400:"#ffea00",A700:"#ffd600"},amber:{50:"#fff8e1",100:"#ffecb3",200:"#ffe082",300:"#ffd54f",400:"#ffca28",500:"#ffc107",600:"#ffb300",700:"#ffa000",800:"#ff8f00",900:"#ff6f00",A100:"#ffe57f",A200:"#ffd740",A400:"#ffc400",A700:"#ffab00"},orange:{50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},"deep-orange":{50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",A100:"#ff9e80",A200:"#ff6e40",A400:"#ff3d00",A700:"#dd2c00"},brown:{50:"#efebe9",100:"#d7ccc8",200:"#bcaaa4",300:"#a1887f",400:"#8d6e63",500:"#795548",600:"#6d4c41",700:"#5d4037",800:"#4e342e",900:"#3e2723",A100:"#d7ccc8",A200:"#bcaaa4",A400:"#8d6e63",A700:"#5d4037"},grey:{50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#ffffff",A200:"#000000",A400:"#303030",A700:"#616161"},"blue-grey":{50:"#eceff1",100:"#cfd8dc",200:"#b0bec5",300:"#90a4ae",400:"#78909c",500:"#607d8b",600:"#546e7a",700:"#455a64",800:"#37474f",900:"#263238",A100:"#cfd8dc",A200:"#b0bec5",A400:"#78909c",A700:"#455a64"}},g=new Array,ae=["blue","green","red","amber","blue-grey","purple","light-green","indigo","pink","yellow","light-blue","orange","deep-purple","lime","teal","brown","cyan","deep-orange","grey"],M=["500","A700","600","700","800","900","300","400","A200","A400"];for(let r of Object.keys(re)){let a=re[r];for(let f of Object.keys(a))if(M.indexOf(f)>-1){let e=a[f],t=ee(e),n=t.isDark(),i={value:t.toHexString(),group:r,label:f,isDark:n};g.push(i)}}g.sort((r,a)=>{let f=M.indexOf(r.label),e=M.indexOf(a.label),t=f-e;if(t===0){let n=ae.indexOf(r.group),i=ae.indexOf(a.group);t=n-i}return t});u();var l=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};l.prototype.stripComments=function(r){var a=new RegExp(this.cssCommentsRegex,"gi");return r.replace(a,"")};l.prototype.parseCSS=function(r){if(r===void 0)return[];for(var a=[];;){var f=this.cssImportStatementRegex.exec(r);if(f!==null)this.cssImportStatements.push(f[0]),a.push({selector:"@imports",type:"imports",styles:f[0]});else break}r=r.replace(this.cssImportStatementRegex,"");for(var e=new RegExp(this.cssKeyframeRegex,"gi"),t;t=e.exec(r),t!==null;)a.push({selector:"@keyframes",type:"keyframes",styles:t[0]});r=r.replace(e,"");for(var n=new RegExp(this.combinedCSSRegex,"gi");t=n.exec(r),t!==null;){var i="";t[2]===void 0?i=t[5].split(`\r
`).join(`
`).trim():i=t[2].split(`\r
`).join(`
`).trim();var s=new RegExp(this.cssCommentsRegex,"gi"),o=s.exec(i);if(o!==null&&(i=i.replace(s,"").trim()),i.indexOf("@media")!==-1){var c={selector:i,type:"media",subStyles:this.parseCSS(t[3]+`
}`)};o!==null&&(c.comments=o[0]),a.push(c)}else{var oe=this.parseRules(t[6]),A={selector:i,rules:oe};i==="@font-face"&&(A.type="font-face"),o!==null&&(A.comments=o[0]),a.push(A)}}return a};l.prototype.parseRules=function(r){r=r.split(`\r
`).join(`
`);var a=[];r=r.split(/;(?![^\(]*\))/);for(var f=0;f<r.length;f++){var e=r[f];if(e=e.trim(),e.indexOf(":")!==-1){e=e.split(":");var t=e[0].trim(),n=e.slice(1).join(":").trim();if(t.length<1||n.length<1)continue;a.push({directive:t,value:n})}else e.trim().substr(0,7)=="base64,"?a[a.length-1].value+=e.trim():e.length>0&&a.push({directive:"",value:e,defective:!0})}return a};l.prototype.findCorrespondingRule=function(r,a,f){f===void 0&&(f=!1);for(var e=!1,t=0;t<r.length&&!(r[t].directive==a&&(e=r[t],f===r[t].value));t++);return e};l.prototype.findBySelector=function(r,a,f){f===void 0&&(f=!1);for(var e=[],t=0;t<r.length;t++)f===!1?r[t].selector===a&&e.push(r[t]):r[t].selector.indexOf(a)!==-1&&e.push(r[t]);if(e.length<2)return e;var n=e[0];for(t=1;t<e.length;t++)this.intelligentCSSPush([n],e[t]);return[n]};l.prototype.deleteBySelector=function(r,a){for(var f=[],e=0;e<r.length;e++)r[e].selector!==a&&f.push(r[e]);return f};l.prototype.compressCSS=function(r){for(var a=[],f={},e=0;e<r.length;e++){var t=r[e];if(f[t.selector]!==!0){var n=this.findBySelector(r,t.selector);n.length!==0&&(a.push(n[0]),f[t.selector]=!0)}}return a};l.prototype.cssDiff=function(r,a){if(r.selector!==a.selector||r.type==="media"||a.type==="media")return!1;for(var f={selector:r.selector,rules:[]},e,t,n=0;n<r.rules.length;n++)e=r.rules[n],t=this.findCorrespondingRule(a.rules,e.directive,e.value),(t===!1||e.value!==t.value)&&f.rules.push(e);for(var i=0;i<a.rules.length;i++)t=a.rules[i],e=this.findCorrespondingRule(r.rules,t.directive),e===!1&&(t.type="DELETED",f.rules.push(t));return f.rules.length===0?!1:f};l.prototype.intelligentMerge=function(r,a,f){f===void 0&&(f=!1);for(var e=0;e<a.length;e++)this.intelligentCSSPush(r,a[e],f);for(e=0;e<r.length;e++){var t=r[e];t.type==="media"||t.type==="keyframes"||(t.rules=this.compactRules(t.rules))}};l.prototype.intelligentCSSPush=function(r,a,f){var e=a.selector,t=!1;if(f===void 0&&(f=!1),f===!1){for(var n=0;n<r.length;n++)if(r[n].selector===a.selector){t=r[n];break}}else for(var i=r.length-1;i>-1;i--)if(r[i].selector===a.selector){t=r[i];break}if(t===!1)r.push(a);else if(a.type!=="media")for(var s=0;s<a.rules.length;s++){var o=a.rules[s],c=this.findCorrespondingRule(t.rules,o.directive);c===!1?t.rules.push(o):o.type=="DELETED"?c.type="DELETED":c.value=o.value}else t.subStyles=a.subStyles};l.prototype.compactRules=function(r){for(var a=[],f=0;f<r.length;f++)r[f].type!=="DELETED"&&a.push(r[f]);return a};l.prototype.getCSSForEditor=function(r,a){a===void 0&&(a=0);var f="";r===void 0&&(r=this.css);for(var e=0;e<r.length;e++)r[e].type=="imports"&&(f+=r[e].styles+`

`);for(e=0;e<r.length;e++){var t=r[e];if(t.selector!==void 0){var n="";t.comments!==void 0&&(n=t.comments+`
`),t.type=="media"?(f+=n+t.selector+`{
`,f+=this.getCSSForEditor(t.subStyles,a+1),f+=`}

`):t.type!=="keyframes"&&t.type!=="imports"&&(f+=this.getSpaces(a)+n+t.selector+` {
`,f+=this.getCSSOfRules(t.rules,a+1),f+=this.getSpaces(a)+`}

`)}}for(e=0;e<r.length;e++)r[e].type=="keyframes"&&(f+=r[e].styles+`

`);return f};l.prototype.getImports=function(r){for(var a=[],f=0;f<r.length;f++)r[f].type=="imports"&&a.push(r[f].styles);return a};l.prototype.getCSSOfRules=function(r,a){for(var f="",e=0;e<r.length;e++)r[e]!==void 0&&(r[e].defective===void 0?f+=this.getSpaces(a)+r[e].directive+" : "+r[e].value+`;
`:f+=this.getSpaces(a)+r[e].value+`;
`);return f||`
`};l.prototype.getSpaces=function(r){for(var a="",f=0;f<r*4;f++)a+=" ";return a};l.prototype.applyNamespacing=function(r,a){var f=r,e="."+this.cssPreviewNamespace;a!==void 0&&(e=a),typeof r=="string"&&(f=this.parseCSS(r));for(var t=0;t<f.length;t++){var n=f[t];if(!(n.selector.indexOf("@font-face")>-1||n.selector.indexOf("keyframes")>-1||n.selector.indexOf("@import")>-1||n.selector.indexOf(".form-all")>-1||n.selector.indexOf("#stage")>-1))if(n.type!=="media"){for(var i=n.selector.split(","),s=[],o=0;o<i.length;o++)i[o].indexOf(".supernova")===-1?s.push(e+" "+i[o]):s.push(i[o]);n.selector=s.join(",")}else n.subStyles=this.applyNamespacing(n.subStyles,a)}return f};l.prototype.clearNamespacing=function(r,a){a===void 0&&(a=!1);var f=r,e="."+this.cssPreviewNamespace;typeof r=="string"&&(f=this.parseCSS(r));for(var t=0;t<f.length;t++){var n=f[t];if(n.type!=="media"){for(var i=n.selector.split(","),s=[],o=0;o<i.length;o++)s.push(i[o].split(e+" ").join(""));n.selector=s.join(",")}else n.subStyles=this.clearNamespacing(n.subStyles,!0)}return a===!1?this.getCSSForEditor(f):f};l.prototype.createStyleElement=function(r,a,f){if(f===void 0&&(f=!1),this.testMode===!1&&f!=="nonamespace"&&(a=this.applyNamespacing(a)),typeof a!="string"&&(a=this.getCSSForEditor(a)),f===!0&&(a=this.getCSSForEditor(this.parseCSS(a))),this.testMode!==!1)return this.testMode("create style #"+r,a);var e=document.getElementById(r);e&&e.parentNode.removeChild(e);var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id=r,n.type="text/css",t.appendChild(n),n.styleSheet&&!n.sheet?n.styleSheet.cssText=a:n.appendChild(document.createTextNode(a))};var ne=l;var he=new RegExp(`{${w}:[^{}]+}`,"g"),ie={Sin:"return Math.round(1000*Math.sin(time/5000));",Cos:"return Math.round(1000*Math.cos(time/5000));",Random:`var value = prevValue + Math.random() * 100 - 50;
var multiplier = Math.pow(10, 2 || 0);
var value = Math.round(value * multiplier) / multiplier;
if (value < -1000) {
	value = -1000;
} else if (value > 1000) {
	value = 1000;
}
return value;`},se=[];for(let r of Object.keys(ie))se.push(r);var fe=[d.createdTime.keyName,d.originator.keyName,d.type.keyName,d.severity.keyName,d.status.keyName],Ze=(()=>{let a=class a{constructor(e,t,n,i,s){this.window=e,this.document=t,this.zone=n,this.datePipe=i,this.translate=s,this.iframeMode=!1,this.widgetEditMode=!1,this.editWidgetInfo=null,this.defaultDataKey={name:"f(x)",type:S.function,label:"Sin",color:this.getMaterialColor(0),funcBody:this.getPredefinedFunctionBody("Sin"),settings:{},_hash:Math.random()},this.defaultDatasource={type:D.function,name:D.function,dataKeys:[h(this.defaultDataKey)]},this.defaultAlarmDataKeys=[];let o=null;try{o=e.frameElement}catch{}if(o){this.iframeMode=!0;let c=o.getAttribute("data-widget");c&&c.length&&(this.editWidgetInfo=JSON.parse(c),this.widgetEditMode=!0)}}getPredefinedFunctionsList(){return se}getPredefinedFunctionBody(e){return ie[e]}getDefaultDatasource(e){let t=h(this.defaultDatasource);return e?.length&&(t.dataKeys[0].settings=te(e)),t}initDefaultAlarmDataKeys(){for(let e=0;e<fe.length;e++){let t=fe[e],n={name:t,type:S.alarm,label:this.translate.instant(d[t].name),color:this.getMaterialColor(e),settings:{},_hash:Math.random()};this.defaultAlarmDataKeys.push(n)}}getDefaultAlarmDataKeys(){return this.defaultAlarmDataKeys.length||this.initDefaultAlarmDataKeys(),h(this.defaultAlarmDataKeys)}defaultAlarmFieldContent(e,t){if(b(t)){let n=d[e.name];if(n){if(n.time)return t?this.datePipe.transform(t,"yyyy-MM-dd HH:mm:ss"):"";if(n===d.severity)return this.translate.instant(_.get(t));if(n===d.status)return C.get(t)?this.translate.instant(C.get(t)):t;if(n===d.originatorType)return this.translate.instant(L.get(t).type);if(n.value===d.assignee.value)return""}return t}return""}processWidgetException(e){let t=this.parseException(e,-6);if(t.message?.startsWith("NG0")&&(t.message=`${this.translate.instant("widget.widget-template-error")}<br/>
                       <br/><i>${this.translate.instant("dialog.error-message-title")}</i><br/><br/>${t.message}`),this.widgetEditMode){let n={type:"widgetException",data:t};this.window.parent.postMessage(JSON.stringify(n),"*")}return t}parseException(e,t){return B(e,t)}customTranslation(e,t){if(e&&H(e))if(e.includes(`{${w}`)){let n=e.match(he),i=e;for(let s of n){let o=s.substring(6,s.length-1);i=i.replace(s,this.doTranslate(o,s))}return i}else return this.doTranslate(e,t,U);else return e}doTranslate(e,t,n){let i,s;n?s=n+e:s=e;let o=this.translate.instant(s);return o!==s?i=o+"":i=t,i}guid(){return E()}getMaterialColor(e){let t=e%g.length;return g[t].value}createKey(e,t,n=-1){let i;if(t===S.alarm&&!e.label){let o=d[e.name];o&&(i=this.translate.instant(o.name))}i||(i=e.label||e.name);let s={name:e.name,type:t,label:i,funcBody:e.funcBody,settings:{},_hash:Math.random()};return e.units&&(s.units=e.units),b(e.decimals)&&(s.decimals=e.decimals),e.color?s.color=e.color:n>-1&&(s.color=this.getMaterialColor(n)),O(e.postFuncBody)&&(s.usePostProcessing=!0,s.postFuncBody=e.postFuncBody),s}createLabelFromDatasource(e,t){return q(e,t)}generateColors(e){let t=0;e.forEach(n=>{n.dataKeys.forEach(i=>{i.color||(i.color=this.getMaterialColor(t)),t++})})}stringToHslColor(e,t,n){if(e&&e.length)return`hsl(${Y(e)%360}, ${t}%, ${n}%)`}currentPerfTime(){return this.window.performance&&this.window.performance.now?this.window.performance.now():Date.now()}getQueryParam(e,t=this.window.location.href){e=e.replace(/[\[\]]/g,"\\$&");let i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}removeQueryParams(e){let t=this.window.location.search;for(let i of e)t=this.updateUrlQueryString(t,i,null);let n=[v(),this.window.location.pathname].join("");this.window.history.replaceState({},"",n+t)}updateQueryParam(e,t){let n=[v(),this.window.location.pathname].join(""),i=this.window.location.search,s=this.updateUrlQueryString(i,e,t);this.window.history.replaceState({},"",n+s)}updateUrlQueryString(e,t,n){let i="",s="";if(n!==null&&(i=t+"="+n),e){let o=new RegExp("([?&])"+t+"[^&]*");e.match(o)!==null?(i&&(i="$1"+i),s=e.replace(o,i),s.startsWith("&")&&(s="?"+s.substring(1))):i&&(s=e+"&"+i)}else i&&(s="?"+i);return s}baseUrl(){return v()}deepClone(e,t){return h(e,t)}isUndefined(e){return Q(e)}isDefined(e){return b(e)}isDefinedAndNotNull(e){return x(e)}defaultValue(e,t){return x(e)?e:t}getEntityIdFromDatasource(e){return{id:e.entityId,entityType:e.entityType}}subscribeToEntityTelemetry(e,t,n=V.LATEST_TELEMETRY,i=null){!t&&e.datasources.length>0&&(t=this.getEntityIdFromDatasource(e.datasources[0]));let s=j.createEntityAttributesSubscription(e.telemetryWsService,t,n,e.ngZone,i);return e.telemetrySubscribers||(e.telemetrySubscribers=[]),e.telemetrySubscribers.push(s),s.subscribe(),s.attributeData$.pipe(N(1),P())}objToBase64(e){return Z(e)}base64toString(e){return J(e)}objToBase64URI(e){return z(e)}base64toObj(e){return G(e)}applyCssToElement(e,t,n,i){let s=new ne;s.testMode=!1;let o=`${n}-${E()}`;return s.cssPreviewNamespace=o,s.createStyleElement(o,i),e.addClass(t,o),o}clearCssElement(e,t,n){n&&e.removeClass(n,t);let i=this.document.getElementById(t);i&&i.parentNode.removeChild(i)}};a.\u0275fac=function(t){return new(t||a)(p(R),p(K),p(k),p(W),p(X))},a.\u0275prov=y({token:a,factory:a.\u0275fac,providedIn:"root"});let r=a;return r})();export{R as a,m as b,de as c,ce as d,ue as e,pe as f,be as g,re as h,g as i,ne as j,Ze as k};
