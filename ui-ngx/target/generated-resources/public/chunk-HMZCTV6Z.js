import{a as _}from"./chunk-MRUKSJRB.js";import{Bc as W,Jc as D}from"./chunk-7OOXQFUB.js";import{Aa as B,Ba as Y,Bb as L,Sb as S,ya as F}from"./chunk-2KNKNWMU.js";import{a as v,b as R,g as O,j as P}from"./chunk-Z4H5XVQJ.js";P();var V=O(_());var j=V.GenericOptions,U=V.BaseGauge,N=R(v({},j),{gaugeType:"arc",gaugeWithScale:.75,dashThickness:0,roundedLineCap:!1,gaugeColor:"#777",barColorProcessor:D.fromSettings(W("blue")),symbol:"",hideValue:!1,hideMinMax:!1,fontTitle:"Roboto",fontValue:"Roboto",fontMinMaxSize:10,fontMinMaxStyle:"normal",fontMinMaxWeight:"500",colorMinMax:"#eee",fontMinMax:"Roboto",fontLabelSize:8,fontLabelStyle:"normal",fontLabelWeight:"500",colorLabel:"#eee",fontLabel:"Roboto",neonGlowBrightness:0,colorTicks:"gray",tickWidth:4,ticks:[],isMobile:!1});U.initialize("CanvasDigitalGauge",N);var C=class{static font(a,r,i){return a["font"+r+"Style"]+" "+a["font"+r+"Weight"]+" "+a["font"+r+"Size"]*i+"px "+a["font"+r]}static normalizedValue(a){let r=a.value,i=a.minValue,l=a.maxValue,n=(l-i)*.01;return{normal:r<i?i:r>l?l:r,indented:r<i?i-n:r>l?l+n:r}}static verifyError(a){if(!(a instanceof DOMException&&a.result===2152923147))throw a}},G=(()=>{let a=class a extends U{constructor(i){i=v(v({},N),i||{}),super(a.configure(i)),this.initValueClone()}static configure(i){i.value>i.maxValue&&(i.value=i.maxValue),i.value<i.minValue&&(i.value=i.minValue),i.gaugeType==="donut"&&(Y(i.donutStartAngle)||(i.donutStartAngle=1.5*Math.PI),Y(i.donutEndAngle)||(i.donutEndAngle=i.donutStartAngle+2*Math.PI)),i.ticksValue=[];for(let l of i.ticks)l!==null&&i.ticksValue.push(a.normalizeValue(l,i.minValue,i.maxValue));return i.neonGlowBrightness&&(i.neonColorTitle=S(i.colorTitle).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorLabel=S(i.colorLabel).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorValue=S(i.colorValue).brighten(i.neonGlowBrightness).toRgbString(),i.neonColorMinMax=S(i.colorMinMax).brighten(i.neonGlowBrightness).toRgbString()),i}static normalizeValue(i,l,n){let e=(i-l)/(n-l);return e<=0?0:e>=1?1:e}initValueClone(){let i=this.canvas;this.elementValueClone=i.element.cloneNode(!0),this.contextValueClone=this.elementValueClone.getContext("2d"),this.elementValueClone.initialized=!1,this.contextValueClone.translate(i.drawX,i.drawY),this.contextValueClone.save(),this.elementProgressClone=i.element.cloneNode(!0),this.contextProgressClone=this.elementProgressClone.getContext("2d"),this.elementProgressClone.initialized=!1,this.contextProgressClone.translate(i.drawX,i.drawY),this.contextProgressClone.save()}destroy(){this.contextValueClone=null,this.elementValueClone=null,this.contextProgressClone=null,this.elementProgressClone=null,super.destroy()}update(i){this.canvas.onRedraw=null;let l=super.update(i);return this.initValueClone(),this.canvas.onRedraw=this.draw.bind(this),this.draw(),l}set timestamp(i){this.options.timestamp=i,this.draw()}get timestamp(){return this.options.timestamp}draw(){try{let i=this.canvas;if(!i.drawWidth||!i.drawHeight)return this;let[l,n,e,s]=[-i.drawX,-i.drawY,i.drawWidth,i.drawHeight],h=this.options,d=i.elementClone;if(!d.initialized){let f=i.contextClone;f.clearRect(l,n,e,s),f.save();let b=i.context;b.barDimensions=q(f,h,l,n,e,s),this.contextValueClone.barDimensions=b.barDimensions,this.contextProgressClone.barDimensions=b.barDimensions,J(f,h),K(f,h),h.showUnitTitle&&A(f,h,h.unitTitle,"labelY"),Q(f,h),d.initialized=!0}let o=!1;if(!this.elementValueClone.initialized||B(this._value)&&this.elementValueClone.renderedValue!==this._value||h.showTimestamp&&this.elementValueClone.renderedTimestamp!==this.timestamp){B(this._value)&&(this.elementValueClone.renderedValue=this._value),F(this.elementValueClone.renderedValue)&&(this.elementValueClone.renderedValue=this.value);let f=this.contextValueClone;f.clearRect(l,n,e,s),f.drawImage(i.elementClone,l,n,e,s),Z(f,h,this.elementValueClone.renderedValue),h.showTimestamp&&(A(f,h,h.labelTimestamp,"timeseriesLabelY"),this.elementValueClone.renderedTimestamp=this.timestamp),this.elementValueClone.initialized=!0,o=!0}let u=(C.normalizedValue(h).normal-h.minValue)/(h.maxValue-h.minValue),g=u.toFixed(3);if(!this.elementProgressClone.initialized||this.elementProgressClone.renderedProgress!==g||o){let f=this.contextProgressClone;f.clearRect(l,n,e,s),f.drawImage(this.elementValueClone,l,n,e,s),Number(g)>0&&x(f,h,u),this.elementProgressClone.initialized=!0,this.elementProgressClone.renderedProgress=g}this.canvas.commit(),i.context.clearRect(l,n,e,s),i.context.drawImage(this.elementProgressClone,l,n,e,s),super.draw()}catch(i){C.verifyError(i)}return this}getValueColor(){if(this.contextProgressClone){let i=this.contextProgressClone.currentColor,l=this.options;if(!i){l.barColorProcessor.update(l.value);let n=S(l.barColorProcessor.color);l.neonGlowBrightness?i=n.brighten(l.neonGlowBrightness).toRgbString():i=n.toRgbString()}return i}else return"#000"}};a.heightCache={};let t=a;return t})();function q(t,a,r,i,l,n){t.barDimensions={baseX:r,baseY:i,width:l,height:n};let e=t.barDimensions,s=1;a.gaugeType==="horizontalBar"?s=a.title===""?2.5:2:a.gaugeType==="verticalBar"?s=a.hideMinMax?.35:.5:a.gaugeType==="arc"&&(s=1.5),l/n>s?(e.width=n*s,e.height=n):(e.width=l,e.height=l/s),e.origBaseX=e.baseX,e.origBaseY=e.baseY,e.baseX+=(l-e.width)/2,e.baseY+=(n-e.height)/2,a.gaugeType==="donut"?e.fontSizeFactor=Math.max(e.width,e.height)/125:a.gaugeType==="verticalBar"||a.gaugeType==="arc"&&a.title===""?e.fontSizeFactor=Math.max(e.width,e.height)/150:e.fontSizeFactor=Math.max(e.width,e.height)/200;let d=a.gaugeWidthScale;if(a.neonGlowBrightness&&(a.fontTitleHeight=M(a,"Title",e.fontSizeFactor),a.fontLabelHeight=M(a,"Label",e.fontSizeFactor),a.fontValueHeight=M(a,"Value",e.fontSizeFactor),a.fontMinMaxHeight=M(a,"MinMax",e.fontSizeFactor)),a.gaugeType==="donut"){if(e.Ro=e.width/2-e.width/20,e.Cy=e.baseY+e.height/2,a.title&&typeof a.title=="string"&&a.title.length>0){let o=M(a,"Title",e.fontSizeFactor).height;o+=e.fontSizeFactor*2,e.titleY=e.baseY+o,o+=e.fontSizeFactor*2,e.Cy+=o/2,e.Ro-=o/2}e.Ri=e.Ro-e.width/6.666666666666667*d*1.2,e.Cx=e.baseX+e.width/2}else a.gaugeType==="arc"?(a.title&&typeof a.title=="string"&&a.title.length>0?(e.Ro=e.width/2-e.width/7,e.Ri=e.Ro-e.width/6.666666666666667*d):(e.Ro=e.width/2-e.fontSizeFactor*4,e.Ri=e.Ro-e.width/6.666666666666667*d*1.2),e.Cx=e.baseX+e.width/2,e.Cy=e.baseY+e.height/1.25):a.gaugeType==="verticalBar"?(e.Ro=e.width/2-e.width/10,e.Ri=e.Ro-e.width/6.666666666666667*d*(a.hideMinMax?4:2.5)):(e.Ro=e.width/2-e.width/10,e.Ri=e.Ro-e.width/6.666666666666667*d);if(e.strokeWidth=e.Ro-e.Ri,e.Rm=e.Ri+e.strokeWidth*.5,e.fontValueBaseline="alphabetic",e.fontMinMaxBaseline="alphabetic",e.fontMinMaxAlign="center",a.gaugeType==="donut")if(e.fontValueBaseline="middle",a.showUnitTitle||a.showTimestamp){let o=M(a,"Value",e.fontSizeFactor).height,u=M(a,"Label",e.fontSizeFactor).height,g=o+u;e.labelY=e.Cy+g/2,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.valueY=e.Cy-g/2+o/2}else e.valueY=e.Cy;else if(a.gaugeType==="arc")e.titleY=e.Cy-e.Ro-12*e.fontSizeFactor,e.valueY=e.Cy,e.labelY=e.Cy+(8+a.fontLabelSize)*e.fontSizeFactor,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.minY=e.maxY=e.labelY,a.roundedLineCap&&(e.minY+=e.strokeWidth/2,e.maxY+=e.strokeWidth/2),e.minX=e.Cx-e.Rm,e.maxX=e.Cx+e.Rm;else if(a.gaugeType==="horizontalBar")if(e.titleY=e.baseY+4*e.fontSizeFactor+(a.title===""?0:a.fontTitleSize*e.fontSizeFactor),e.titleBottom=e.titleY+(a.title===""?0:4)*e.fontSizeFactor,e.valueY=e.titleBottom+(a.hideValue?0:a.fontValueSize*e.fontSizeFactor),e.barTop=e.valueY+8*e.fontSizeFactor,e.barBottom=e.barTop+e.strokeWidth,a.hideMinMax&&!a.showUnitTitle&&!a.showTimestamp)e.labelY=e.barBottom,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.barLeft=e.origBaseX+a.fontMinMaxSize/3*e.fontSizeFactor,e.barRight=e.origBaseX+l+-a.fontMinMaxSize/3*e.fontSizeFactor;else{t.font=C.font(a,"MinMax",e.fontSizeFactor);let o=t.measureText(a.minValue+"").width,u=t.measureText(a.maxValue+"").width,g=Math.max(o,u);e.minX=e.origBaseX+g/2+a.fontMinMaxSize/3*e.fontSizeFactor,e.maxX=e.origBaseX+l+-g/2-a.fontMinMaxSize/3*e.fontSizeFactor,e.barLeft=e.minX,e.barRight=e.maxX,e.labelY=e.barBottom+(8+a.fontLabelSize)*e.fontSizeFactor,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),e.minY=e.maxY=e.labelY}else a.gaugeType==="verticalBar"&&(e.titleY=e.baseY+((a.title===""?0:a.fontTitleSize)+8)*e.fontSizeFactor,e.titleBottom=e.titleY+(a.title===""?0:4)*e.fontSizeFactor,e.valueY=e.titleBottom+(a.hideValue?0:a.fontValueSize*e.fontSizeFactor),e.barTop=e.valueY+8*e.fontSizeFactor,e.labelY=e.baseY+e.height,e.timeseriesLabelY=y(a,e.labelY,e.fontSizeFactor),a.showUnitTitle||a.showTimestamp?e.barBottom=e.labelY-a.fontLabelSize*e.fontSizeFactor:e.barBottom=e.labelY,e.minX=e.maxX=e.baseX+e.width/2+e.strokeWidth/2+a.fontMinMaxSize/3*e.fontSizeFactor,e.minY=e.barBottom,e.maxY=e.barTop,e.fontMinMaxBaseline="middle",e.fontMinMaxAlign="left");if(a.dashThickness){let o;a.gaugeType==="donut"?o=Math.PI*e.Rm*2:a.gaugeType==="arc"?o=Math.PI*e.Rm:a.gaugeType==="horizontalBar"?o=e.barRight-e.barLeft:a.gaugeType==="verticalBar"&&(o=e.barBottom-e.barTop);let u=Math.floor(o/(a.dashThickness*e.fontSizeFactor));a.gaugeType==="donut"?u=(u|1)-1:u=u-1|1,e.dashLength=Math.ceil(o/u)}return e}function y(t,a,r){return t.showUnitTitle?a+t.fontLabelSize*r*1.2:a}function M(t,a,r){let i="font-style:"+t["font"+a+"Style"]+";font-weight:"+t["font"+a+"Weight"]+";font-size:"+t["font"+a+"Size"]*r+"px;font-family:"+t["font"+a],l=G.heightCache[i];if(!l){let n={fontFamily:t["font"+a],fontSize:t["font"+a+"Size"]*r+"px",fontWeight:t["font"+a+"Weight"],fontStyle:t["font"+a+"Style"]},e=$("<span>Hg</span>").css(n),s=$('<div style="display: inline-block; width: 1px; height: 0;"></div>'),h=$("<div></div>");h.append(e,s),$("body").append(h);try{l={},s.css({verticalAlign:"baseline"}),l.ascent=s.offset().top-e.offset().top,s.css({verticalAlign:"bottom"}),l.height=s.offset().top-e.offset().top,l.descent=l.height-l.ascent}finally{h.remove()}G.heightCache[i]=l}return l}function J(t,a){let{barLeft:r,barRight:i,barTop:l,barBottom:n,width:e,baseX:s,strokeWidth:h}=t.barDimensions;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]),t.beginPath(),t.strokeStyle=a.gaugeColor,t.lineWidth=h,a.roundedLineCap&&(t.lineCap="round"),a.gaugeType==="donut"?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,a.donutStartAngle,a.donutEndAngle),t.stroke()):a.gaugeType==="arc"?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,Math.PI,2*Math.PI),t.stroke()):a.gaugeType==="horizontalBar"?(t.moveTo(r,l+h/2),t.lineTo(i,l+h/2),t.stroke()):a.gaugeType==="verticalBar"&&(t.moveTo(s+e/2,n),t.lineTo(s+e/2,l),t.stroke())}function z(t,a,r,i,l,n){t.fillStyle=a[(a.neonGlowBrightness?"neonColor":"color")+r],t.fillText(i,l,n)}function K(t,a){if(!a.title||typeof a.title!="string")return;let{titleY:r,width:i,baseX:l,fontSizeFactor:n}=t.barDimensions,e=Math.round(l+i/2),s=r;t.save(),t.textAlign="center",t.font=C.font(a,"Title",n),t.lineWidth=0,z(t,a,"Title",a.title.toUpperCase(),e,s),t.restore()}function A(t,a,r,i){if(!r||r==="")return;let{baseX:l,width:n,fontSizeFactor:e}=t.barDimensions,s=Math.round(l+n/2),h=t.barDimensions[i];t.save(),t.textAlign="center",t.font=C.font(a,"Label",e),t.lineWidth=0,z(t,a,"Label",r,s,h),t.restore()}function Q(t,a){if(a.hideMinMax||a.gaugeType==="donut")return;let{minY:r,maxY:i,minX:l,maxX:n,fontSizeFactor:e,fontMinMaxAlign:s,fontMinMaxBaseline:h}=t.barDimensions;t.save(),t.textAlign=s,t.textBaseline=h,t.font=C.font(a,"MinMax",e),t.lineWidth=0,z(t,a,"MinMax",a.minValue+"",l,r),z(t,a,"MinMax",a.maxValue+"",n,i),t.restore()}function Z(t,a,r){if(a.hideValue)return;let{valueY:i,baseX:l,width:n,fontSizeFactor:e,fontValueBaseline:s}=t.barDimensions,h=Math.round(l+n/2),d=i,o=a.valueText||L(r,a.valueDec);o+=a.symbol,t.save(),t.textAlign="center",t.textBaseline=s,t.font=C.font(a,"Value",e),t.lineWidth=0,z(t,a,"Value",o,h,d),t.restore()}function X(t,a,r,i,l,n,e,s,h,d,o){t.setLineDash([]);let u=n-i,g=.55,f=u*g;t.lineWidth=u+f;let b=g/(2*g+2),m=t.createRadialGradient(a,r,i-f/2,a,r,n+f/2),c=S(e).setAlpha(.5).toRgbString(),T=S(e).setAlpha(0).toRgbString();m.addColorStop(0,T),m.addColorStop(b,c),m.addColorStop(1-b,c),m.addColorStop(1,T),t.strokeStyle=m,t.beginPath();let w=.01*Math.PI;h?t.arc(a,r,l,d-w,d+(o-d)*s+w):t.arc(a,r,l,Math.PI-w,Math.PI+Math.PI*s+w),t.stroke()}function I(t,a,r,i,l,n,e,s){t.setLineDash([]);let h=.55,d=e*h;t.lineWidth=e+d;let o=h/(2*h+2),u=s?a-t.lineWidth/2:0,g=s?0:r-t.lineWidth/2,f=s?a+t.lineWidth/2:0,b=s?0:r+t.lineWidth/2,m=t.createLinearGradient(u,g,f,b),c=S(n).setAlpha(.5).toRgbString(),T=S(n).setAlpha(0).toRgbString();m.addColorStop(0,T),m.addColorStop(o,c),m.addColorStop(1-o,c),m.addColorStop(1,T),t.strokeStyle=m;let w=s?0:.05*t.lineWidth,k=s?.05*t.lineWidth:0;t.beginPath(),t.moveTo(a-w,r+k),t.lineTo(i+w,l-k),t.stroke()}function H(t,a,r,i,l,n,e,s,h,d,o){if(!a.length)return;let u=e-l;t.beginPath(),t.lineWidth=o,t.strokeStyle=d;for(let g of a){let f=s+g*h,b=r+(l+u)*Math.cos(f),m=i+(l+u)*Math.sin(f),c=r+l*Math.cos(f),T=i+l*Math.sin(f);t.moveTo(b,m),t.lineTo(c,T)}t.stroke()}function E(t,a,r,i,l,n,e,s,h){if(a.length){t.beginPath(),t.lineWidth=h,t.strokeStyle=s;for(let d of a){let o=d*l;e?(t.moveTo(r-n/2,i+o-l),t.lineTo(r+n/2,i+o-l)):(t.moveTo(r+o,i),t.lineTo(r+o,i+n))}t.stroke()}}function x(t,a,r){let i;t.save(),a.barColorProcessor.update(a.value);let l=S(a.barColorProcessor.color);a.neonGlowBrightness?t.currentColor=i=l.brighten(a.neonGlowBrightness).toRgbString():t.currentColor=t.strokeStyle=l.toRgbString();let{barLeft:n,barRight:e,barTop:s,baseX:h,width:d,barBottom:o,Cx:u,Cy:g,Rm:f,Ro:b,Ri:m,strokeWidth:c}=t.barDimensions;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]),t.lineWidth=c,a.roundedLineCap?t.lineCap="round":t.lineCap="butt",a.gaugeType==="donut"?(a.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.arc(u,g,f,a.donutStartAngle,a.donutStartAngle+(a.donutEndAngle-a.donutStartAngle)*r),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&X(t,u,g,m,f,b,i,r,!0,a.donutStartAngle,a.donutEndAngle),H(t,a.ticksValue,u,g,m,f,b,a.donutStartAngle,a.donutEndAngle-a.donutStartAngle,a.colorTicks,a.tickWidth)):a.gaugeType==="arc"?(a.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.arc(u,g,f,Math.PI,Math.PI+Math.PI*r),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&X(t,u,g,m,f,b,i,r,!1),H(t,a.ticksValue,u,g,m,f,b,Math.PI,Math.PI,a.colorTicks,a.tickWidth)):a.gaugeType==="horizontalBar"?(a.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.moveTo(n,s+c/2),t.lineTo(n+(e-n)*r,s+c/2),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&I(t,n,s+c/2,n+(e-n)*r,s+c/2,i,c,!1),E(t,a.ticksValue,n,s,e-n,c,!1,a.colorTicks,a.tickWidth)):a.gaugeType==="verticalBar"&&(a.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.moveTo(h+d/2,o),t.lineTo(h+d/2,o-(o-s)*r),t.stroke(),a.neonGlowBrightness&&!a.isMobile&&I(t,h+d/2,o,h+d/2,o-(o-s)*r,i,c,!0),E(t,a.ticksValue,h+d/2,s,s-o,c,!0,a.colorTicks,a.tickWidth)),t.restore()}export{C as a,G as b};
